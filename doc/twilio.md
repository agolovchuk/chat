# Twilio

Для начала работы с сервислм необходимо зарегестрироваться и получить необходимые токины.
- [Creating Access Tokens](https://www.twilio.com/docs/chat/create-tokens)

У токенов есть буквенные префиксы, на это соит обратить внимание, т.к. это помагает не запутатся в их многообразии.

## MiddleEnd
Необходимо реализовать свой MiddleEnd, его роль заключается в том чтобы получать сессионные токены и обновлять их когда они истекают. По жизенному циклу токенов есть соответствующий [раздел в документации](https://www.twilio.com/docs/chat/access-token-lifecycle). <br/>
В нашем случае мы создали Node сервер на [Koa](https://koajs.com/) у которого есть один endpoint по которому мы получаем сессионный токен для пользователя. В нашем примере нет проверки того кто получает этот токен, в реальной жизни это необходимо реализовывать.

## FrontEnd
Архитектурно было решено использовать минимальное количество зависимостей т.к. задача у нас - быстро интегрировать чат в любой проект на ReactJS.
Исходя из этого строим интеграцию на обновленном [Context API](https://ru.reactjs.org/docs/context.html) для ReactJS.<br/>
Нам никто не мешает внедрить Redux или другой state manager на усмотрение интегратора, но для данной конкретной задачи это оверхед.

### Быстрый старт
Обернем в провайдер компонет в котором будит находится чат.

 ```
  <ChatProvider>
    <App />
  </ChatProvider>
 ```
Совсем не обязательно оборачивать все приложение, достаточно лиш компонент верхнего уровня в котором мы будим использовать чат.

Сомпонеты в которых мы хотим пользоватся API необходимо обернуть в декоратор
```
function Component(props) {
  return (
    <div>
      ...
    </div>
  )
}
export chatConnect(Component);
```

### API
В примере реализованны базовые методы минимально необходимые для работы интеграции:
* connect
* createGroupChannel
* createPrivatChannel
* joinChannel
* getMessage
* onSendMessage
* getGroupChannelName
* getPrivatChannelName
* getGroupChannelTitle
* getPrivatChannelTitle
